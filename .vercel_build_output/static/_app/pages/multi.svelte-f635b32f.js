var ie=Object.defineProperty,ne=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var Z=(l,e,t)=>e in l?ie(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,x=(l,e)=>{for(var t in e||(e={}))ue.call(e,t)&&Z(l,t,e[t]);if(Q)for(var t of Q(e))me.call(e,t)&&Z(l,t,e[t]);return l},$=(l,e)=>ne(l,fe(e));import{S as ce,i as pe,s as _e,e as E,k as G,c as v,a as N,m as J,d as c,b as B,g as h,J as y,t as I,h as k,M as Y,E as se,P as ge,j as X,w as de,x as be,y as he,q as ye,o as we,B as Se,v as Ie,L as ke}from"../chunks/index-ec26513d.js";import{B as Ee,g as ve}from"../chunks/Board-8ee8ca34.js";import{u as Te,a as Re,d as j}from"../chunks/user-b5e473cf.js";import"../chunks/paths-c0fc83a9.js";import"../chunks/index-63348562.js";var z,Be=new Uint8Array(16);function Ne(){if(!z&&(z=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!z))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return z(Be)}var Oe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ge(l){return typeof l=="string"&&Oe.test(l)}var b=[];for(var W=0;W<256;++W)b.push((W+256).toString(16).substr(1));function Je(l){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(b[l[e+0]]+b[l[e+1]]+b[l[e+2]]+b[l[e+3]]+"-"+b[l[e+4]]+b[l[e+5]]+"-"+b[l[e+6]]+b[l[e+7]]+"-"+b[l[e+8]]+b[l[e+9]]+"-"+b[l[e+10]]+b[l[e+11]]+b[l[e+12]]+b[l[e+13]]+b[l[e+14]]+b[l[e+15]]).toLowerCase();if(!Ge(t))throw TypeError("Stringified UUID is invalid");return t}function Le(l,e,t){l=l||{};var n=l.random||(l.rng||Ne)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var s=0;s<16;++s)e[t+s]=n[s];return e}return Je(n)}function ee(l){let e,t,n,s=l[3]&&te(l),o=l[1]&&le(l),a=l[4]&&oe(l);return{c(){e=E("div"),s&&s.c(),t=G(),o&&o.c(),n=G(),a&&a.c(),this.h()},l(i){e=v(i,"DIV",{class:!0});var f=N(e);s&&s.l(f),t=J(f),o&&o.l(f),n=J(f),a&&a.l(f),f.forEach(c),this.h()},h(){B(e,"class","absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 bg-[black] w-screen h-screen bg-opacity-90 flex justify-center items-center flex-col text-xl")},m(i,f){h(i,e,f),s&&s.m(e,null),y(e,t),o&&o.m(e,null),y(e,n),a&&a.m(e,null)},p(i,f){i[3]?s?s.p(i,f):(s=te(i),s.c(),s.m(e,t)):s&&(s.d(1),s=null),i[1]?o?o.p(i,f):(o=le(i),o.c(),o.m(e,n)):o&&(o.d(1),o=null),i[4]?a?a.p(i,f):(a=oe(i),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(i){i&&c(e),s&&s.d(),o&&o.d(),a&&a.d()}}}function te(l){let e,t,n,s,o,a,i,f;return{c(){e=E("div"),t=E("button"),n=I("New game"),s=G(),o=E("button"),a=I("Join game"),this.h()},l(_){e=v(_,"DIV",{});var u=N(e);t=v(u,"BUTTON",{class:!0});var p=N(t);n=k(p,"New game"),p.forEach(c),s=J(u),o=v(u,"BUTTON",{class:!0});var g=N(o);a=k(g,"Join game"),g.forEach(c),u.forEach(c),this.h()},h(){B(t,"class","m-2 bg-orange p-1"),B(o,"class","m-2 bg-orange p-1")},m(_,u){h(_,e,u),y(e,t),y(t,n),y(e,s),y(e,o),y(o,a),i||(f=[Y(t,"click",l[12]),Y(o,"click",l[13])],i=!0)},p:se,d(_){_&&c(e),i=!1,ge(f)}}}function le(l){let e,t,n,s,o,a,i,f,_;return{c(){e=E("p"),t=I("Game Id"),n=G(),s=E("p"),o=I("(share with friends)"),a=G(),i=E("p"),f=I("http://localhost:3000/multi?id="),_=I(l[2]),this.h()},l(u){e=v(u,"P",{});var p=N(e);t=k(p,"Game Id"),p.forEach(c),n=J(u),s=v(u,"P",{class:!0});var g=N(s);o=k(g,"(share with friends)"),g.forEach(c),a=J(u),i=v(u,"P",{class:!0});var T=N(i);f=k(T,"http://localhost:3000/multi?id="),_=k(T,l[2]),T.forEach(c),this.h()},h(){B(s,"class","text-base"),B(i,"class","text-orange")},m(u,p){h(u,e,p),y(e,t),h(u,n,p),h(u,s,p),y(s,o),h(u,a,p),h(u,i,p),y(i,f),y(i,_)},p(u,p){p&4&&X(_,u[2])},d(u){u&&c(e),u&&c(n),u&&c(s),u&&c(a),u&&c(i)}}}function oe(l){let e,t,n,s;return{c(){e=E("input"),t=G(),n=E("button"),s=I("Join"),this.h()},l(o){e=v(o,"INPUT",{type:!0,class:!0,placeholder:!0}),t=J(o),n=v(o,"BUTTON",{class:!0});var a=N(n);s=k(a,"Join"),a.forEach(c),this.h()},h(){B(e,"type","text"),B(e,"class","bg-blue p-1"),B(e,"placeholder","Game id"),B(n,"class","m-2 bg-orange p-1")},m(o,a){h(o,e,a),l[14](e),h(o,t,a),h(o,n,a),y(n,s)},p:se,d(o){o&&c(e),l[14](null),o&&c(t),o&&c(n)}}}function Me(l){let e,t,n,s=(localStorage.getItem("you")||l[9])+"",o,a,i,f,_=(l[8].split(" ").length==2?l[8].split(" ")[1][0]:"")+"",u,p,g,T,R,S,O,P,C,d=l[5]&&ee(l);return S=new Ee({props:{multi:!0,board:l[7],turn:l[9],game_state:l[10]}}),{c(){d&&d.c(),e=G(),t=E("p"),n=I("You: "),o=I(s),a=G(),i=E("p"),f=I("current turn: "),u=I(_),p=G(),g=E("button"),T=I("Resign"),R=G(),de(S.$$.fragment),this.h()},l(r){d&&d.l(r),e=J(r),t=v(r,"P",{class:!0});var m=N(t);n=k(m,"You: "),o=k(m,s),m.forEach(c),a=J(r),i=v(r,"P",{class:!0});var w=N(i);f=k(w,"current turn: "),u=k(w,_),w.forEach(c),p=J(r),g=v(r,"BUTTON",{});var L=N(g);T=k(L,"Resign"),L.forEach(c),R=J(r),be(S.$$.fragment,r),this.h()},h(){B(t,"class","-z-10"),B(i,"class","-z-10")},m(r,m){d&&d.m(r,m),h(r,e,m),h(r,t,m),y(t,n),y(t,o),h(r,a,m),h(r,i,m),y(i,f),y(i,u),h(r,p,m),h(r,g,m),y(g,T),h(r,R,m),he(S,r,m),O=!0,P||(C=Y(g,"click",l[15]),P=!0)},p(r,[m]){r[5]?d?d.p(r,m):(d=ee(r),d.c(),d.m(e.parentNode,e)):d&&(d.d(1),d=null),(!O||m&512)&&s!==(s=(localStorage.getItem("you")||r[9])+"")&&X(o,s),(!O||m&256)&&_!==(_=(r[8].split(" ").length==2?r[8].split(" ")[1][0]:"")+"")&&X(u,_);const w={};m&128&&(w.board=r[7]),m&512&&(w.turn=r[9]),m&1024&&(w.game_state=r[10]),S.$set(w)},i(r){O||(ye(S.$$.fragment,r),O=!0)},o(r){we(S.$$.fragment,r),O=!1},d(r){d&&d.d(r),r&&c(e),r&&c(t),r&&c(a),r&&c(i),r&&c(p),r&&c(g),r&&c(R),Se(S,r),P=!1,C()}}}function Pe(l,e,t){let n=["a","b","c","d","e","f","g","h"],s={g:{tile_color:"w",tile_type:"goat"},h:{tile_color:"w",tile_type:"horse"},t:{tile_color:"w",tile_type:"tiger"},b:{tile_color:"w",tile_type:"bear"},l:{tile_color:"w",tile_type:"snake"},m:{tile_color:"w",tile_type:"mantis-shrimp"},r:{tile_color:"w",tile_type:"bird"},s:{tile_color:"w",tile_type:"sloth"},G:{tile_color:"o",tile_type:"goat"},H:{tile_color:"o",tile_type:"horse"},T:{tile_color:"o",tile_type:"tiger"},B:{tile_color:"o",tile_type:"bear"},L:{tile_color:"o",tile_type:"snake"},M:{tile_color:"o",tile_type:"mantis-shrimp"},R:{tile_color:"o",tile_type:"bird"},S:{tile_color:"o",tile_type:"sloth"}};function o(m){let w={};const L=m.split(" ");localStorage.setItem("turn",L[1][0]);const U=L[0].split("/");return U.forEach((re,F)=>{const ae=n[F];let K=re.split("");if(U.length!=8){console.log("bad fen string");return}let H=0;for(let D=0;D<K.length;D++){const V=K[D];if(parseInt(V)){const M=parseInt(V);for(let q=0;q<M;q++){let A=ae+(H+q+1);w[A]={id:A,tile_type:"",tile_color:"",tile:"",el:document.getElementById(A)}}H+=M}else{let M=n[F]+(H+1);w[M]=$(x({id:M,tile:ve(s[V].tile_color,s[V].tile_type)},s[V]),{el:document.getElementById(M)}),H++}}}),w}let a,i=!1,f="SAMPLE",_=!0,u=!1,p=!0,g,T,R;T=JSON.parse(localStorage.getItem("board")),R=localStorage.getItem("fen_state")||"null w";let S="w",O;Ie(async()=>{const m=new URLSearchParams(window.location.search);!Te.is&&!Re.get("u")&&(window.location.href="/login"),m.get("id")&&(t(2,f=m.get("id")),localStorage.setItem("game_id",f),localStorage.setItem("you","o"),t(6,g=j.get(f)),t(5,p=!1)),localStorage.getItem("game_id")&&(t(2,f=localStorage.getItem("game_id")),t(6,g=j.get(f)),t(5,p=!1)),localStorage.getItem("fen_state")||localStorage.setItem("fen_state","GHTBLMRS/8/8/8/8/8/8/ghtblmrs w"),localStorage.getItem("board")||localStorage.setItem("fen_state",JSON.stringify(o("GHTBLMRS/8/8/8/8/8/8/ghtblmrs w"))),g.map().once(w=>{t(8,R=w);let L=o(w);if(localStorage.getItem("turn")!=localStorage.getItem("you")?t(9,S=""):t(9,S=localStorage.getItem("turn")),localStorage.setItem("board",JSON.stringify(L)),R.split(" ")[1].length>=2&&R.split(" ")[1][1]=="r"){let U=R.split(" ")[1][0];U=="w"&&t(10,O={win:!1,stale:!1,resign:!0,who:"Orange",state:"White won the game!"}),U=="o"&&t(10,O={win:!1,stale:!1,resign:!0,who:"White",state:"Orange won the game!"})}t(7,T=L)})});const P=async()=>{t(3,_=!1),t(1,i=!0),t(2,f="game_"+Le().replace(/\-/g,"_"));let m=localStorage.getItem("fen_state");localStorage.setItem("game_id",f),localStorage.setItem("you","w"),t(6,g=j.get("game_"+f)),g.set(m)},C=()=>{t(4,u=!0),t(3,_=!1)};function d(m){ke[m?"unshift":"push"](()=>{a=m,t(0,a)})}return[a,i,f,_,u,p,g,T,R,S,O,o,P,C,d,()=>{localStorage.removeItem("game_id"),localStorage.removeItem("you"),localStorage.removeItem("fen_state"),localStorage.setItem("board",JSON.stringify(o("GHTBLMRS/8/8/8/8/8/8/ghtblmrs w"))),localStorage.setItem("fen_state","GHTBLMRS/8/8/8/8/8/8/ghtblmrs w"),j.get(f).set(localStorage.getItem("fen_state")+"r"),t(5,p=!0)}]}class De extends ce{constructor(e){super(),pe(this,e,Pe,Me,_e,{})}}export{De as default};
